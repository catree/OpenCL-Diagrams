%!TEX root = ../main.tex

\begin{figure}[p]
\centering
\begin{tikzpicture}[scale=0.9,transform shape]

  % Processors
  \path                       node[draw,thick,fill=Yellow!70,minimum width=22em,minimum height=19em,inner sep=0.3cm,rounded corners=8pt] (cpu) {};
  \path (cpu.east) +(5.0,0.0) node[draw,thick,fill=Yellow!70,minimum width=22em,minimum height=19em,inner sep=0.3cm,rounded corners=8pt] (gpu) {};
  \node[below] at ($(cpu.north)+(0.0,-0.2)$) {\sffamily\bfseries\LARGE{CPU}};
  \node[below] at ($(gpu.north)+(0.0,-0.2)$) {\sffamily\bfseries\LARGE{GPU}};

  % Memory
  \path (cpu.south) +(0.0,-1.7) node[draw,thick,fill=BurntOrange!70,minimum width=22em,minimum height=7em,inner sep=0.3cm,rounded corners=8pt] (cpu-memory) {\sffamily\bfseries\Large{System Memory}};
  \path (gpu.south) +(0.0,-1.7) node[draw,thick,fill=BurntOrange!70,minimum width=22em,minimum height=7em,inner sep=0.3cm,rounded corners=8pt] (gpu-memory) {\sffamily\bfseries\Large{Device Memory}};

  % CPU
  \path (cpu.north west) +(0.5,-1.1) node[anchor=north west,draw,fill=SeaGreen!80,text centered,minimum width=10.5em,minimum height=8em,inner sep=0.3cm,rounded corners=8pt] (cpu-control) {\sffamily\bfseries\Large{Control}};
  \path (cpu.south west) +(0.5,0.5) node[anchor=south west,draw,fill=RedOrange!80,text centered,minimum width=19.45em,minimum height=6em,inner sep=0.3cm,rounded corners=8pt] (cpu-cache) {\sffamily\bfseries\Large{Cache}};
  \path (cpu-control.north east) +(0.3,0.0) node[anchor=north west,draw,fill=RoyalBlue!80,text centered,minimum width=3.8em,minimum height=3.8em,inner sep=0.3cm,rounded corners=8pt] (cpu-alu-0) {\sffamily\bfseries\large{ALU}};
  \path (cpu-alu-0.north east) +(0.15,0.0) node[anchor=north west,draw,fill=RoyalBlue!80,text centered,minimum width=3.8em,minimum height=3.8em,inner sep=0.3cm,rounded corners=8pt] (cpu-alu-1) {\sffamily\bfseries\large{ALU}};
  \path (cpu-control.south east) +(0.3,0.0) node[anchor=south west,draw,fill=RoyalBlue!80,text centered,minimum width=3.8em,minimum height=3.8em,inner sep=0.3cm,rounded corners=8pt] (cpu-alu-2) {\sffamily\bfseries\large{ALU}};
  \path (cpu-alu-2.north east) +(0.15,0.0) node[anchor=north west,draw,fill=RoyalBlue!80,text centered,minimum width=3.8em,minimum height=3.8em,inner sep=0.3cm,rounded corners=8pt] (cpu-alu-3) {\sffamily\bfseries\large{ALU}};
  
  % GPU
  % \core{<id>}{<pos>}
  \DeclareDocumentCommand \core { m m }{%
    \path #2 node[anchor=north west,draw,fill=SeaGreen!80,text centered,minimum width=2.5em,minimum height=0.4em,rounded corners=2.5pt] (gpu-control-#1) {};
    \path (gpu-control-#1.south west) +(0.0,-0.07) node[anchor=north west,draw,fill=RedOrange!80,text centered,minimum width=2.5em,minimum height=0.4em,rounded corners=2.5pt] (gpu-cache-#1) {};
    \path (gpu-control-#1.north east) +(0.07,0.0) node[anchor=north west,draw,fill=RoyalBlue!80,text centered,minimum width=1.9em,minimum height=1.55em,rounded corners=3pt] (gpu-alu-#1-0) {};
    \path (gpu-alu-#1-0.north east) +(0.07,0.0) node[anchor=north west,draw,fill=RoyalBlue!80,text centered,minimum width=1.9em,minimum height=1.55em,rounded corners=3pt] (gpu-alu-#1-1) {};
    \path (gpu-alu-#1-1.north east) +(0.07,0.0) node[anchor=north west,draw,fill=RoyalBlue!80,text centered,minimum width=1.9em,minimum height=1.55em,rounded corners=3pt] (gpu-alu-#1-2) {};
    \path (gpu-alu-#1-2.north east) +(0.07,0.0) node[anchor=north west,draw,fill=RoyalBlue!80,text centered,minimum width=1.9em,minimum height=1.55em,rounded corners=3pt] (gpu-alu-#1-3) {};
    \path (gpu-alu-#1-3.north east) +(0.07,0.0) node[anchor=north west,draw,fill=RoyalBlue!80,text centered,minimum width=1.9em,minimum height=1.55em,rounded corners=3pt] (gpu-alu-#1-4) {};
    \path (gpu-alu-#1-4.north east) +(0.07,0.0) node[anchor=north west,draw,fill=RoyalBlue!80,text centered,minimum width=1.9em,minimum height=1.55em,rounded corners=3pt] (gpu-alu-#1-5) {};
    \path (gpu-alu-#1-5.north east) +(0.07,0.0) node[anchor=north west,draw,fill=RoyalBlue!80,text centered,minimum width=1.9em,minimum height=1.55em,rounded corners=3pt] (gpu-alu-#1-6) {};
    \path (gpu-alu-#1-6.north east) +(0.07,0.0) node[anchor=north west,draw,fill=RoyalBlue!80,text centered,minimum width=1.9em,minimum height=1.55em,rounded corners=3pt] (gpu-alu-#1-7) {};
  }
  \core{0}{($(gpu.north west)+(0.5,-1.2)$)}
  \core{1}{($(gpu-cache-0.south west)+(0.0,-0.105)$)}
  \core{2}{($(gpu-cache-1.south west)+(0.0,-0.105)$)}
  \core{3}{($(gpu-cache-2.south west)+(0.0,-0.105)$)}
  \core{4}{($(gpu-cache-3.south west)+(0.0,-0.105)$)}
  \core{5}{($(gpu-cache-4.south west)+(0.0,-0.105)$)}
  \core{6}{($(gpu-cache-5.south west)+(0.0,-0.105)$)}
  \core{7}{($(gpu-cache-6.south west)+(0.0,-0.105)$)}

\end{tikzpicture}
\caption{CPU and GPU architectures.}
\label{fig:processor-architectures}
\end{figure}
